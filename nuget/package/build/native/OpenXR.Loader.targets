<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

    <Choose>
        <When Condition="'$(ApplicationType)|$(ApplicationTypeRevision)' == 'Windows Store|10.0'">
            <PropertyGroup>
                <OpenXRLoaderBinaryRoot>$(OpenXRPackageRoot)native\$(Platform)_uwp\release</OpenXRLoaderBinaryRoot>
            </PropertyGroup>
        </When>
        <Otherwise>
            <PropertyGroup>
                <OpenXRLoaderBinaryRoot>$(OpenXRPackageRoot)native\$(Platform)\release</OpenXRLoaderBinaryRoot>
            </PropertyGroup>
        </Otherwise>
    </Choose>

    <ItemDefinitionGroup>
        <ClCompile>
            <AdditionalIncludeDirectories>%(AdditionalIncludeDirectories);$(OpenXRPackageRoot)include</AdditionalIncludeDirectories>
        </ClCompile>
        <Link>
            <AdditionalDependencies>%(AdditionalDependencies);$(OpenXRLoaderBinaryRoot)\lib\openxr_loader.lib</AdditionalDependencies>
        </Link>
    </ItemDefinitionGroup>

    <!-- Copy the OpenXR loader DLL to the output directory -->
    <ItemGroup Condition="'$(OpenXRSkipLoaderCopy)'!='true'">
        <Content
            Include="$(OpenXRLoaderBinaryRoot)\bin\openxr_loader.dll"
            Link="%(Filename)%(Extension)"
            CopyToOutputDirectory="PreserveNewest" />
    </ItemGroup>

    <Target Name="EnsurePropsImported" BeforeTargets="PrepareForBuild">
        <Error Condition="'$(OpenXRPackageRoot)'==''" Text="OpenXRPackageRoot property missing. Project is malformed. Try removing and re-adding the NuGet reference." />
    </Target>

</Project>
